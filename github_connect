#!/bin/bash

# Kontrollime, kas skript käivitatakse root kasutajana
if [ "$EUID" -ne 0 ]; then
  echo "Palun käivita skript root kasutajana."
  exit 1
fi

# Kontrollime, kas Git on installitud
if ! command -v git &> /dev/null; then
  echo "Git ei ole installitud. Paigaldame Git..."
  apt update && apt install -y git
  echo "Git on paigaldatud."
else
  echo "Git on juba installitud."
fi

# Fikseeritud GitHub kasutajanimi ja email
username="Adrian69420N"
email="adrian.vorms@voco.ee"

# Seadista Git kasutajanimi ja email
git config --global user.name "$username"
git config --global user.email "$email"

# Kontrolli, kas SSH võti juba eksisteerib
if [ ! -f ~/.ssh/id_rsa ]; then
  # Loo uus SSH võti
  ssh-keygen -t rsa -b 4096 -C "$email" -N "" -f ~/.ssh/id_rsa
  echo "SSH võti loodud."
else
  echo "SSH võti juba eksisteerib."
fi

# Kuvame SSH avaliku võtme
echo "Kopeeri järgmine avalik võti ja lisa see oma GitHub kontole:"
cat ~/.ssh/id_rsa.pub

# Testime ühendust GitHubiga
echo "Testime ühendust GitHubiga..."
ssh -T git@github.com

echo "Valmis! Kui ühendus õnnestus, on arvuti nüüd GitHubiga ühendatud."
